package protocolsupport.protocol.utils.i18n;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.stream.Collectors;

import protocolsupport.utils.Utils;

public class I18NData {

	public static final String DEFAULT_LOCALE = "en_us";

	private static final HashMap<String, I18N> i18ns = new HashMap<>();

	static {
		//the languages file is generated by the gradle build script
		new BufferedReader(new InputStreamReader(Utils.getResource("i18n/languages"))).lines().forEach(locale -> loadLocale(locale));
	}

	private static void loadLocale(String locale) {
		I18N i18n = new I18N(locale);
		i18n.load(new BufferedReader(new InputStreamReader(Utils.getResource("i18n/" + locale + ".lang"))).lines().collect(Collectors.toList()));
		i18ns.put(locale, i18n);
	}

	public static I18N getI18N(String locale) {
		return i18ns.getOrDefault(locale, i18ns.get(DEFAULT_LOCALE));
	}

	public static String i18n(String locale, String key, String... args) {
		return String.format(getI18N(locale).getI18N(key), (Object[]) args);
	}

}
